<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>è‹±å›½ QS Top 100 åæ ¡äº¤äº’å¯¹æ¯”ç³»ç»Ÿ</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.4.1/dist/MarkerCluster.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.4.1/dist/MarkerCluster.Default.css" />
    <script src="https://unpkg.com/leaflet.markercluster@1.4.1/dist/leaflet.markercluster.js"></script>

    <style>
        :root { --primary: #002366; --accent: #c8102e; --gray: #f4f7f6; }
        body { background-color: #f0f2f5; margin: 0; font-family: 'Segoe UI', Arial, sans-serif; }
        
        .main-container {
            max-width: 1400px; margin: 20px auto; background: #fff;
            padding: 20px; border-radius: 15px; display: flex; gap: 20px; height: 65vh;
        }

        #sidebar { width: 320px; display: flex; flex-direction: column; background: var(--gray); border-radius: 10px; padding: 10px; }
        #university-list { flex: 1; overflow-y: auto; }
        .uni-item { 
            padding: 10px; margin-bottom: 5px; background: #fff; border: 1px solid #ddd; 
            border-radius: 5px; cursor: pointer; font-size: 13px; transition: 0.2s;
        }
        .uni-item:hover { border-color: var(--accent); background: #fff9f9; }
        .uni-item.selected { border-left: 5px solid var(--accent); background: #fff5f5; font-weight: bold; }

        #map { flex: 1; border-radius: 10px; z-index: 1; }

        .comparison-section {
            max-width: 1400px; margin: 20px auto; background: #fff;
            padding: 25px; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            min-height: 200px;
        }
        .comp-table { width: 100%; border-collapse: collapse; margin-top: 15px; }
        .comp-table th, .comp-table td { border: 1px solid #eee; padding: 12px; text-align: left; font-size: 14px; }
        .dim-label { background: #f8f9fa; width: 140px; font-weight: bold; color: #666; }
        .uni-name-header { background: var(--primary) !important; color: white !important; text-align: center; font-size: 16px; }
        
        /* å¼¹çª—æ ·å¼ */
        .u-popup { line-height: 1.6; font-size: 13px; min-width: 250px; }
        .u-title { font-weight: bold; font-size: 15px; color: var(--primary); border-bottom: 2px solid var(--accent); margin-bottom: 8px; }
        .tag-qs { background: #f1c40f; color: #333; padding: 1px 5px; border-radius: 3px; font-size: 11px; float: right; }
        .label { font-weight: bold; color: #555; }
        .val-highlight { color: var(--accent); font-weight: bold; }
        .placeholder { text-align: center; padding: 40px; color: #999; border: 2px dashed #eee; border-radius: 10px; }
        hr { border: 0; border-top: 1px solid #eee; margin: 8px 0; }

        /* æ•°æ®æ¥æºå°å­—æ ·å¼ */
        .data-source { 
            font-size: 12px; color: #999; text-align: right; margin-top: 15px; 
            font-style: italic; border-top: 1px dashed #eee; padding-top: 10px;
        }

        /* ç§Ÿé‡‘è¿›åº¦æ¡æ ·å¼ */
        .rent-bar-container { background: #eee; border-radius: 10px; height: 10px; width: 100%; margin-top: 8px; overflow: hidden; }
        .rent-bar-fill { height: 100%; background: linear-gradient(90deg, #f1c40f, #e67e22, #c8102e); transition: width 0.6s ease-in-out; }
        .rent-label { display: flex; justify-content: space-between; font-size: 11px; margin-top: 4px; color: #888; }
    </style>
</head>
<body>

<div id="header-area" style="text-align: center; padding: 20px 0;">
    <h1 style="color: var(--primary); margin: 0;">ğŸ‡¬ğŸ‡§ è‹±å›½ QS Top 100 åæ ¡æ·±åº¦å¯¹æ¯”åœ°å›¾</h1>
    <p style="color: #666;">ç‚¹å‡»å·¦ä¾§åˆ—è¡¨é€‰æ‹© 2 æ‰€å­¦æ ¡å¼€å¯æ·±åº¦å¯¹æ¯” | ç ”ç©¶ç”Ÿç”³è¯·å¾®ä¿¡å’¨è¯¢ï¼šwmcx123456</p>
</div>

<div class="main-container">
    <div id="sidebar">
        <div style="margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center;">
            <strong>å­¦æ ¡åå½• (QS 2026)</strong>
            <button onclick="resetSelection()" style="cursor:pointer; padding: 2px 8px;">é‡ç½®</button>
        </div>
        <div id="university-list"></div>
    </div>
    <div id="map"></div>
</div>

<div class="comparison-section">
    <div id="comp-grid">
        <div class="placeholder">è¯·åœ¨ä¸Šæ–¹åˆ—è¡¨å‹¾é€‰ 2 æ‰€å­¦æ ¡å¼€å¯æ·±åº¦å¯¹æ¯”</div>
    </div>
</div>

<script>
    // --- å®Œæ•´ 17 æ‰€å­¦æ ¡æ•°æ®ä¿æŒä¸å˜ ---
   const universityData = [
    { 
        name: "å¸å›½ç†å·¥å­¦é™¢ (Imperial)", 
        city: "ä¼¦æ•¦ (South Kensington)", 
        coords: [51.4988, -0.1749], 
        qsRank: 2, 
        group: "G5 / ç½—ç´ é›†å›¢", 
        strength: "ç†å·¥ç§‘ã€åŒ»å­¦ã€å•†å­¦é™¢ (å…¨è‹±äº§ç ”ç»“åˆæœ€ç´§å¯†çš„å­¦åºœ)", 
        economy: "ä½äºä¼¦æ•¦æ ¸å¿ƒè…¹åœ°ï¼Œå…¨çƒé‡‘èä¸é«˜ç§‘æŠ€å·¨å¤´æ€»éƒ¨äº‘é›†ï¼Œå°±ä¸šèµ„æºé¡¶çº§", 
        env: "å…¸å‹çš„ç²¾è‹±ä¸»ä¹‰æ°›å›´ï¼Œç´§é‚»æµ·å¾·å…¬å›­ä¸åšç‰©é¦†åŒºï¼Œç”Ÿæ´»èŠ‚å¥æå¿«", 
        dist: "South Kensington (æœ¬éƒ¨); White City (åˆ›æ–°å›­åŒº); Silwood Park (ç”Ÿæ€)", 
        rent: "Â£350 - Â£550/å‘¨", 
        traffic: "South Kensington åœ°é“ç«™ (è“çº¿/é»„çº¿/ç»¿çº¿æ¢çº½)",
        employ: "92% (é›‡ä¸»å£°èª‰å…¨çƒé¢†å…ˆï¼ŒSTEM æ¯•ä¸šç”Ÿé¦–é€‰ç›®æ ‡)", 
        intl: "çº¦ 60% (æé«˜çš„å›½é™…åŒ–ç¨‹åº¦)" 
    },
    { 
        name: "ç‰›æ´¥å¤§å­¦ (Oxford)", 
        city: "ç‰›æ´¥", 
        coords: [51.7548, -1.2544], 
        qsRank: 4, 
        group: "G5 / ç½—ç´ é›†å›¢", 
        strength: "äººæ–‡ã€åŒ»å­¦ã€PPE (æ”¿ç»å“²å­¦)ã€ç”Ÿå‘½ç§‘å­¦", 
        economy: "ä¸–ç•Œçº§åˆ¶è¯ä¸­å¿ƒ (é˜¿æ–¯åˆ©åº·æ€»éƒ¨) ä¸é«˜ç§‘æŠ€è¡ç”Ÿä¼ä¸šèšé›†åœ°", 
        env: "å¤è€çš„å­¦é™¢åˆ¶å»ºç­‘ï¼Œå…¨åŸçš†æ ¡ï¼Œå­¦æœ¯è£èª‰æ„Ÿä¸å†å²åšé‡æ„Ÿæå¼º", 
        dist: "åˆ†å¸ƒäºå…¨å¸‚çš„ 39 ä¸ªç‹¬ç«‹å­¦é™¢ (Colleges)", 
        rent: "Â£190 - Â£350/å‘¨", 
        traffic: "ä¸»è¦ä¾é æ­¥è¡Œä¸è‡ªè¡Œè½¦ï¼›Gloucester Green å·´å£«ç«™ç›´è¾¾ä¼¦æ•¦",
        employ: "91% (å…¨çƒç²¾è‹±æ ¡å‹ç½‘ç»œï¼Œé¡¶çº§æŠ•è¡Œä¸å¾‹æ‰€çš„ç»å¯¹ Target School)", 
        intl: "çº¦ 45% (æ±‡èšå…¨çƒé¡¶å°–å­¦è€…ä¸ç²¾è‹±å­å¼Ÿ)" 
    },
    { 
        name: "å‰‘æ¡¥å¤§å­¦ (Cambridge)", 
        city: "å‰‘æ¡¥", 
        coords: [52.2043, 0.1149], 
        qsRank: 6, 
        group: "G5 / ç½—ç´ é›†å›¢", 
        strength: "æ•°å­¦ã€ç‰©ç†ã€è®¡ç®—æœºç§‘å­¦ã€å·¥ç¨‹å­¦", 
        economy: "â€œç¡…æ²¼ (Silicon Fen)â€ æ¬§æ´²é¡¶çº§é«˜ç§‘æŠ€äº§ä¸šé›†ç¾¤æ ¸å¿ƒï¼Œç§‘æŠ€åˆ›ä¸šæ²ƒåœŸ", 
        env: "ä¼˜ç¾çš„åº·æ²³æ™¯è§‚ï¼Œä¸¥è°¨ä¸”é™è°§çš„å­¦æœ¯æ®¿å ‚ï¼Œç§‘ç ”å‹åŠ›è¾ƒå¤§", 
        dist: "åˆ†å¸ƒäºå…¨åŸçš„ 31 ä¸ªç‹¬ç«‹å­¦é™¢ (Colleges)", 
        rent: "Â£180 - Â£340/å‘¨", 
        traffic: "è‘—åçš„è‡ªè¡Œè½¦ä¹‹åŸï¼Œæ­¥è¡Œå¯è¾¾å¤§éƒ¨åˆ†å­¦æœ¯æœºæ„",
        employ: "90% (ç§‘æŠ€åˆ›ä¸šä¸å­¦æœ¯ç§‘ç ”é¢†åŸŸæ‹¥æœ‰å…¨çƒç»Ÿæ²»åŠ›)", 
        intl: "çº¦ 40% (å›½é™…å­¦ç”Ÿç«äº‰æå…¶æ¿€çƒˆï¼Œç”Ÿæºæä¼˜)" 
    },
    { 
        name: "ä¼¦æ•¦å¤§å­¦å­¦é™¢ (UCL)", 
        city: "ä¼¦æ•¦ (Bloomsbury)", 
        coords: [51.5246, -0.1340], 
        qsRank: 9, 
        group: "G5 / ç½—ç´ é›†å›¢", 
        strength: "æ•™è‚²å­¦ (IOE)ã€å»ºç­‘å­¦ (Bartlett)ã€ç¥ç»ç§‘å­¦ã€æ³•å¾‹", 
        economy: "åœ°å¤„ä¼¦æ•¦ä¸€åŒºï¼Œå‘¨è¾¹éå¸ƒæ™ºåº“ã€åšç‰©é¦†ä¸å…¨çƒå’¨è¯¢å…¬å¸æ€»éƒ¨", 
        env: "å…¸å‹çš„éƒ½å¸‚å¼€æ”¾å¼æ ¡å›­ï¼Œç”±äºåœ°å¤„æ ¸å¿ƒåŒºï¼Œæ ¡åŒºä¸è¡—é“èåˆï¼Œæå…¶ä¾¿åˆ©", 
        dist: "Bloomsbury (æ ¸å¿ƒåŒº); UCL East (å¥¥è¿æ‘æ–°æ ¡åŒº)", 
        rent: "Â£320 - Â£500/å‘¨", 
        traffic: "Euston / Euston Square / Warren Street å¤šä¸ªæ¢çº½åŒ…å›´",
        employ: "88% (ä¼¦æ•¦å°±ä¸šå¸‚åœºè®¤å¯åº¦æé«˜ï¼Œå…¨çƒè·¨å›½ä¼ä¸šæ ¸å¿ƒç”Ÿæºåœ°)", 
        intl: "çº¦ 55% (æåº¦å¤šå…ƒåŒ–ï¼Œä¸­å›½å­¦ç”ŸåŸºæ•°è¾ƒå¤§)" 
    },
    { 
        name: "ä¼¦æ•¦å›½ç‹å­¦é™¢ (KCL)", 
        city: "ä¼¦æ•¦ (Strand)", 
        coords: [51.5115, -0.1160], 
        qsRank: 31, 
        group: "ç½—ç´ é›†å›¢", 
        strength: "ç²¾ç¥åŒ»å­¦ (IoPPN)ã€æŠ¤ç†å­¦ã€å›½é™…å…³ç³»ã€æˆ˜äº‰ç ”ç©¶", 
        economy: "åè½æ³°æ™¤å£«æ²³ç•”ï¼Œæ¯—é‚»å¸æ³•æœºå…³ã€è®®ä¼šä¸ä¸–ç•Œé¡¶å°–ç ”ç©¶å‹åŒ»é™¢", 
        env: "æå…·è‹±ä¼¦çš‡å®¤é£æ ¼ï¼Œå„æ ¡åŒºå‡ä½äºä¼¦æ•¦ç»å¯¹æ ¸å¿ƒåœ°å¸¦ï¼Œäººæ–‡æ°”æ¯æµ“éƒ", 
        dist: "Strand (äººæ–‡); Guy's (åŒ»å­¦); Waterloo (ç¤¾ç§‘); Denmark Hill (å¿ƒç†)", 
        rent: "Â£320 - Â£480/å‘¨", 
        traffic: "Temple / Waterloo / London Bridge åœ°é“ç«™ç¯ç»•",
        employ: "86% (åœ¨å…¬å…±æ”¿ç­–ã€åŒ»ç–—å«ç”Ÿã€æ³•å¾‹ç•Œæ‹¥æœ‰æå¼ºçš„å½±å“åŠ›)", 
        intl: "çº¦ 50% (é«˜åº¦å›½é™…åŒ–çš„ç²¾è‹±å­¦åºœ)" 
    },
    { 
        name: "çˆ±ä¸å ¡å¤§å­¦ (Edinburgh)", 
        city: "çˆ±ä¸å ¡", 
        coords: [55.9445, -3.1892], 
        qsRank: 34, 
        group: "ç½—ç´ é›†å›¢", 
        strength: "ä¿¡æ¯å­¦ (AIå…¨è‹±é¡¶å°–)ã€è‰ºæœ¯è®¾è®¡ã€äººæ–‡å†å²ã€å…½åŒ»", 
        economy: "è‹æ ¼å…°é¦–åºœï¼Œè‹±å›½é™¤ä¼¦æ•¦å¤–æœ€å¤§çš„é‡‘èä¸­å¿ƒï¼Œå•†ä¸šæ°›å›´ç¨³å¥", 
        env: "æå…¶å£®ä¸½çš„è‹æ ¼å…°å¤å…¸é£æ ¼ï¼Œå¤åŸåŒºä¸å­¦æœ¯åŒºäº¤ç»‡ï¼Œé£æ™¯å¦‚ç”»", 
        dist: "Central Area (äººæ–‡); King's Buildings (ç†å·¥); Little France (åŒ»å­¦)", 
        rent: "Â£200 - Â£350/å‘¨", 
        traffic: "å…¬äº¤ç½‘ç»œæå…¶å‘è¾¾ï¼ŒWaverley ç«è½¦ç«™è¿é€šè‹±å›½å…¨å¢ƒ",
        employ: "82% (åœ¨è‹æ ¼å…°åŠå…¨çƒå­¦æœ¯ç•Œæ‹¥æœ‰å¼ºå¤§å¨æœ›)", 
        intl: "çº¦ 45% (æ·±å—åŒ—ç¾ä¸äºšæ´²å­¦ç”Ÿé’ç)" 
    },
    { 
        name: "æ›¼å½»æ–¯ç‰¹å¤§å­¦ (Manchester)", 
        city: "æ›¼å½»æ–¯ç‰¹", 
        coords: [53.4668, -2.2339], 
        qsRank: 35, 
        group: "ç½—ç´ é›†å›¢", 
        strength: "å•†ç§‘ã€ç‰©ç†å­¦ (çŸ³å¢¨çƒ¯å‘ç°åœ°)ã€åŒ–å­¦å·¥ç¨‹ã€ææ–™å­¦", 
        economy: "è‹±å›½â€œåŒ—æ–¹ç»æµå¼•æ“â€æ ¸å¿ƒï¼Œæ•°å­—åª’ä½“ä¸å…ˆè¿›åˆ¶é€ åŸºåœ°ï¼Œæˆæœ¬è¾ƒä½", 
        env: "å……æ»¡æ´»åŠ›çš„éƒ½å¸‚å¤§å­¦ï¼Œä¼ ç»Ÿçº¢ç –ä¸ç°ä»£å»ºç­‘ç»“åˆï¼Œå­¦ç”Ÿæ´»åŠ¨æä¸°å¯Œ", 
        dist: "Oxford Road (ä¸»æ ¡åŒº); Fallowfield (ä¸»è¦ä½å®¿åŒº)", 
        rent: "Â£160 - Â£280/å‘¨", 
        traffic: "å…¨æ¬§æ´²æœ€ç¹å¿™çš„å…¬äº¤èµ°å»Š Oxford Road ç›´è¾¾å¸‚åŒºæ¢çº½",
        employ: "85% (è¿ç»­å¤šå¹´è‰è”è‹±å›½æœ€å—é¡¶çº§é›‡ä¸»æ¬¢è¿å¤§å­¦ç¬¬ä¸€å)", 
        intl: "çº¦ 40% (å…¨è‹±å­¦ç”Ÿè§„æ¨¡æœ€å¤§çš„å¤§å­¦ä¹‹ä¸€)" 
    },
    { 
        name: "å¸ƒé‡Œæ–¯æ‰˜å¤§å­¦ (Bristol)", 
        city: "å¸ƒé‡Œæ–¯æ‰˜", 
        coords: [51.4584, -2.6030], 
        qsRank: 51, 
        group: "ç½—ç´ é›†å›¢", 
        strength: "èˆªç©ºèˆªå¤©å·¥ç¨‹ã€å½±è§†åˆ¶ä½œã€åœ°çƒç§‘å­¦ã€é€šç”¨å·¥ç¨‹", 
        economy: "è‹±å›½è¥¿å—éƒ¨åˆ›æ„äº§ä¸šä¸å·¥ç¨‹å·¥ä¸š (ç©ºå®¢/ç½—ç½—) æ¢çº½ï¼Œç»æµå……æ»¡æ´»åŠ›", 
        env: "ä½äºæå…·è‰ºæœ¯æ°”æ¯çš„å±±åŸï¼Œç¯å¢ƒä¼˜ç¾ï¼Œæ ¡å›­ä¸åŸå¸‚ç¤¾åŒºæ— ç¼èåˆ", 
        dist: "Clifton (ä¸»æ ¡åŒº); Langford (å…½åŒ»)", 
        rent: "Â£180 - Â£320/å‘¨", 
        traffic: "å…¬äº¤ç½‘ç»œè¦†ç›–å…¨å¸‚ï¼ŒClifton åŒºåŸŸå¤šä¸ºå¡é“ï¼Œæ­¥è¡Œè¾ƒå¤š",
        employ: "84% (æ¯•ä¸šç”Ÿå¹¿æ³›è¿›å…¥é¡¶çº§å·¥ç¨‹ä¼ä¸šä¸åˆ›æ„åª’ä½“è¡Œä¸š)", 
        intl: "çº¦ 30% (ä»¥æœ¬åœŸåŠæ¬§ç¾å­¦ç”Ÿä¸ºä¸»ï¼Œè¿‘å¹´äºšæ´²æ¯”ä¾‹ç¨³æ­¥ä¸Šå‡)" 
    },
    { 
        name: "ä¼¦æ•¦æ”¿æ²»ç»æµå­¦é™¢ (LSE)", 
        city: "ä¼¦æ•¦ (Holborn)", 
        coords: [51.5144, -0.1165], 
        qsRank: 56, 
        group: "G5 / ç½—ç´ é›†å›¢", 
        strength: "ç»æµå­¦ã€ç¤¾ä¼šå­¦ã€æ”¿æ²»å­¦ã€ä¼šè®¡é‡‘è (å…¨è‹±å•†ç§‘é¡¶å°–)", 
        economy: "ç›´æ¥åµŒå…¥ä¼¦æ•¦æ³•å¾‹ä¸é‡‘èä¸­å¿ƒï¼Œæ ¡å‹èµ„æºæ·±åº¦è¦†ç›–å…¨çƒæ”¿å•†ç•Œ", 
        env: "ç´§å‡‘çš„éƒ½å¸‚æ ¡å›­ï¼Œå…¸å‹çš„â€œç¤¾ä¼šç²¾è‹±é¢„å¤‡å½¹â€æ°›å›´ï¼ŒèŒåœºå¯¼å‘æå¼º", 
        dist: "Houghton Street (æ ¸å¿ƒå•æ ¡åŒº)", 
        rent: "Â£350 - Â£550/å‘¨", 
        traffic: "Holborn / Temple åœ°é“ç«™æ­¥è¡Œ 5 åˆ†é’Ÿ",
        employ: "90% (åœ¨æŠ•è¡Œã€å’¨è¯¢ã€æ”¿åºœæœºæ„ä¸­æ‹¥æœ‰æ— å¯æ¯”æ‹Ÿçš„æ‹›è˜ä¼˜åŠ¿)", 
        intl: "çº¦ 70% (å›½é™…ç”Ÿæ¯”ä¾‹å…¨è‹±æœ€é«˜ï¼Œæå…¶å…¨çƒåŒ–)" 
    },
    { 
        name: "åå¨å¤§å­¦ (Warwick)", 
        city: "è€ƒæ–‡å‚/æ²ƒé‡Œå…‹", 
        coords: [52.3793, -1.5615], 
        qsRank: 74, 
        group: "ç½—ç´ é›†å›¢", 
        strength: "æ•°å­¦ã€WBS å•†å­¦é™¢ã€åˆ¶é€ å·¥ç¨‹ (WMG)ã€ç»æµå­¦", 
        economy: "æ¯—é‚»è‹±å›½ä¼ ç»Ÿæ±½è½¦å·¥ä¸šå¸¦ (æ·è±¹è·¯è™)ï¼Œä¸å·¥ä¸šç•Œè”ç³»æå…¶ç´§å¯†", 
        env: "ç°ä»£åŒ–çš„å°é—­å¼æ ¡å›­ï¼Œç”Ÿæ´»è®¾æ–½é½å…¨ï¼Œå®‰å…¨ä¸”é€‚åˆæ½œå¿ƒå­¦ä¹ ", 
        dist: "Main Campus (æ ¸å¿ƒ); Gibbet Hill (åŒ»å­¦); Westwood", 
        rent: "Â£150 - Â£250/å‘¨", 
        traffic: "ä¾èµ–æ ¡å·´è‡³ Coventry ç«è½¦ç«™æˆ– Leamington Spa",
        employ: "84% (æ·±å—é¡¶çº§è·¨å›½å’¨è¯¢å…¬å¸ä¸é‡‘èæœºæ„é’ç)", 
        intl: "çº¦ 38% (å•†å­¦é™¢å›½é™…åŒ–ç¨‹åº¦æé«˜)" 
    },
    { 
        name: "ä¼¯æ˜ç¿°å¤§å­¦ (Birmingham)", 
        city: "ä¼¯æ˜ç¿°", 
        coords: [52.4508, -1.9305], 
        qsRank: 76, 
        group: "ç½—ç´ é›†å›¢", 
        strength: "ç‰©ç†ä¸å¤©æ–‡ã€ç”Ÿå‘½ç§‘å­¦ã€ä½“è‚²å­¦ã€åŒ–å­¦å·¥ç¨‹", 
        economy: "è‹±å›½ç¬¬äºŒå¤§åŸå¸‚ä¸­å¿ƒï¼Œåˆ¶é€ ä¸šè½¬å‹é«˜ç§‘æŠ€æœåŠ¡çš„æ¢çº½ï¼Œå®ä¹ æœºä¼šå¤š", 
        env: "çº¢ç –å¤§å­¦ä»£è¡¨ï¼Œæ‹¥æœ‰å…¨è‹±å”¯ä¸€æœ‰ç«è½¦ç«™çš„æ ¡å›­ï¼Œç¯å¢ƒä¼˜ç¾è®¾æ–½å…¨", 
        dist: "Edgbaston (æ ¸å¿ƒæ ¡åŒº); Selly Oak (äººæ–‡/æ•™è‚²)", 
        rent: "Â£160 - Â£260/å‘¨", 
        traffic: "æ ¡å†… University è½¦ç«™ç›´è¾¾å¸‚ä¸­å¿ƒ (10åˆ†é’Ÿ)",
        employ: "81% (åœ¨å·¥ç¨‹ã€åŒ»ç–—ä¸å•†ä¸šé¢†åŸŸæ‹¥æœ‰å¼ºå¤§çš„é›‡ä¸»ç½‘ç»œ)", 
        intl: "çº¦ 35% (å¤šå…ƒåŒ–ç¨‹åº¦ç¨³å¥æå‡)" 
    },
    { 
        name: "æ ¼æ‹‰æ–¯å“¥å¤§å­¦ (Glasgow)", 
        city: "æ ¼æ‹‰æ–¯å“¥ (West End)", 
        coords: [55.8721, -4.2882], 
        qsRank: 79, 
        group: "ç½—ç´ é›†å›¢", 
        strength: "åŒ»å­¦ã€æ³•å¾‹ã€ç‰™åŒ»ã€å…½åŒ»ã€è‹±è¯­æ–‡å­¦", 
        economy: "è‹æ ¼å…°æœ€å¤§æ¸¯å£ä¸å•†ä¸šé‡é•‡ï¼Œæµ·æ´‹å·¥ç¨‹ä¸å•†ä¸šæœåŠ¡ä¸šå‘è¾¾", 
        env: "å¦‚éœæ ¼æ²ƒèŒ¨èˆ¬çš„å“¥ç‰¹å¼ä¸»æ¥¼ï¼Œä½äºæ–‡è‰ºæ°”æ¯æµ“éƒçš„è¥¿åŒºï¼Œåº•è•´æ·±åš", 
        dist: "Gilmorehill (ä¸»æ ¡åŒº); Garscube (å…½åŒ»)", 
        rent: "Â£170 - Â£290/å‘¨", 
        traffic: "æ­¥è¡Œè‡³ Hillhead åœ°é“ç«™æå…¶æ–¹ä¾¿",
        employ: "80% (åœ¨æ³•å¾‹ã€æ•™è‚²ä¸åŒ»ç–—ç³»ç»Ÿæ‹¥æœ‰æé«˜çš„è¡Œä¸šè®¤å¯åº¦)", 
        intl: "çº¦ 38% (è‹æ ¼å…°æœ€å—å›½é™…ç”Ÿæ¬¢è¿çš„å­¦åºœä¹‹ä¸€)" 
    },
    { 
        name: "åˆ©å…¹å¤§å­¦ (Leeds)", 
        city: "åˆ©å…¹", 
        coords: [53.8067, -1.5550], 
        qsRank: 86, 
        group: "ç½—ç´ é›†å›¢", 
        strength: "ä¼ åª’ (å…¨è‹±é¢†å…ˆ)ã€å•†ç§‘ã€é£Ÿå“ç§‘å­¦ã€åœ°çƒç§‘å­¦", 
        economy: "ä¼¦æ•¦å¤–æœ€å¤§çš„æ³•å¾‹ä¸é‡‘èæœåŠ¡ä¸­å¿ƒï¼Œå°±ä¸šå¸‚åœºéå¸¸æ´»è·ƒ", 
        env: "ç´§å‡‘å‹å•ä¸€æ ¡å›­ï¼Œè®¾æ–½ç°ä»£åŒ–ï¼Œç”Ÿæ´»æˆæœ¬ä¸è´¨é‡å¹³è¡¡å¾—æå¥½", 
        dist: "Leeds City Centre (å•ä¸€æ ¸å¿ƒæ ¡åŒº)", 
        rent: "Â£155 - Â£265/å‘¨", 
        traffic: "æ­¥è¡Œå³å¯è¦†ç›–ç»å¤§éƒ¨åˆ†æ•™å­¦åŒºä¸å­¦ç”Ÿå…¬å¯“",
        employ: "82% (åœ¨ä¼ åª’ä¸é‡‘èæœåŠ¡è¡Œä¸šå…·å¤‡æå¼ºçš„æ ¡å‹å½±å“åŠ›)", 
        intl: "çº¦ 33% (ä¸­å›½å­¦ç”Ÿæ¯”ä¾‹é€‚ä¸­ï¼Œæ ¡å›­éå¸¸å¤šå…ƒ)" 
    },
    { 
        name: "å—å®‰æ™®é¡¿å¤§å­¦ (Southampton)", 
        city: "å—å®‰æ™®é¡¿ (Highfield)", 
        coords: [50.9346, -1.3960], 
        qsRank: 87, 
        group: "ç½—ç´ é›†å›¢", 
        strength: "ç”µå­å·¥ç¨‹ (ECS)ã€æµ·æ´‹ç§‘å­¦ã€å…‰ç”µå­å­¦ã€åœŸæœ¨å·¥ç¨‹", 
        economy: "å…¨è‹±æœ€å¤§å®¢è¿æ¸¯ï¼Œè‹±å›½å›½å®¶æµ·æ´‹åœ°ç†ä¸­å¿ƒæ‰€åœ¨åœ°ï¼Œç§‘ç ”è´¸æ˜“å‘è¾¾", 
        env: "å…¸å‹çš„ç»¿æ„æ£®æ—æ ¡å›­ï¼Œç¯å¢ƒæ¸…å¹½é¿ä¸–ï¼Œæ˜¯ä¸“å¿ƒç§‘ç ”çš„ç†æƒ³ä¹‹åœ°", 
        dist: "Highfield (ä¸»æ ¡åŒº); Boldrewood (åˆ›æ–°å·¥ç¨‹); NOC (æµ·æ´‹ä¸­å¿ƒ)", 
        rent: "Â£145 - Â£235/å‘¨", 
        traffic: "Unilink ä¸“å±æ ¡å·´è¿æ¥æ‰€æœ‰æ ¡åŒºä¸æœºåœºç«è½¦ç«™",
        employ: "80% (å·¥ç¨‹ç±»æ¯•ä¸šç”Ÿåœ¨è·¨å›½ç§‘æŠ€å·¨å¤´åŠç§‘ç ”é™¢æ‰€è®¤å¯åº¦æé«˜)", 
        intl: "çº¦ 33% (åœ¨ç†å·¥ç§‘é¢†åŸŸæ‹¥æœ‰æé«˜çš„å›½é™…åŒ–ç¨‹åº¦)" 
    },
    { 
        name: "è°¢è²å°”å¾·å¤§å­¦ (Sheffield)", 
        city: "è°¢è²å°”å¾·", 
        coords: [53.3814, -1.4883], 
        qsRank: 92, 
        group: "ç½—ç´ é›†å›¢", 
        strength: "å·¥ç¨‹å­¦ (å°¤å…¶æ˜¯å…ˆè¿›åˆ¶é€ )ã€å»ºç­‘å­¦ã€æ–°é—»å­¦", 
        economy: "æ›¾ç»çš„â€œé’¢é“ä¹‹åŸâ€å·²è½¬å‹ä¸ºç²¾å¯†åˆ¶é€ ä¸ç ”å‘ä¸­å¿ƒ (æ³¢éŸ³/ç½—ç½—åˆä½œä¼™ä¼´)", 
        env: "ç´§é‚»å³°åŒºå›½å®¶å…¬å›­ï¼Œæ‹¥æœ‰æä½³çš„å­¦ç”Ÿè”ç›Ÿè®¾æ–½ï¼ŒåŸå¸‚äººæƒ…å‘³æµ“éƒ", 
        dist: "Western Bank (ä¸»æ ¡åŒºé›†ç¾¤)", 
        rent: "Â£140 - Â£240/å‘¨", 
        traffic: "å‘è¾¾çš„æœ‰è½¨ç”µè½¦ (Tram) ç©¿è¿‡æ ¡å›­ç›´è¾¾å¸‚ä¸­å¿ƒ",
        employ: "79% (åœ¨åˆ¶é€ ã€å·¥ç¨‹ä¸æ–°é—»é¢†åŸŸæœ‰ç€æé«˜çš„è¡Œä¸šå£ç¢‘)", 
        intl: "çº¦ 30% (ä»¥å‹å¥½çš„å­¦æœ¯æ°›å›´è‘—ç§°)" 
    },
    { 
        name: "æœä¼¦å¤§å­¦ (Durham)", 
        city: "æœä¼¦", 
        coords: [54.7753, -1.5849], 
        qsRank: 94, 
        group: "ç½—ç´ é›†å›¢", 
        strength: "ç¥å­¦ã€åœ°ç†å­¦ã€è€ƒå¤å­¦ã€å¤å…¸å­¦ã€æ³•å¾‹", 
        economy: "å®é™å¤åŸï¼Œä»¥æ•™è‚²ä¸æ—…æ¸¸ä¸šä¸ºæ”¯æŸ±ï¼Œæ¶ˆè´¹æ°´å¹³é€‚ä¸­", 
        env: "æå…·è´µæ—æ°”è´¨çš„å­¦é™¢åˆ¶å¤§å­¦ï¼Œä¸æœä¼¦å¤§æ•™å ‚/åŸå ¡å…±ç”Ÿï¼Œæ°›å›´åº„ä¸¥", 
        dist: "City Campus (æœä¼¦å¸‚ä¸­å¿ƒå„å­¦é™¢é›†ç¾¤)", 
        rent: "Â£165 - Â£280/å‘¨", 
        traffic: "åŸå¸‚æå°ï¼Œç»å¤§éƒ¨åˆ†æ—¶é—´ä¾é æ­¥è¡Œ",
        employ: "83% (æ¯•ä¸šç”Ÿåœ¨ä¼¦æ•¦é¡¶çº§é‡‘èæœºæ„ä¸æ”¿æ³•ç•Œæ‹¥æœ‰æå¼ºçš„å£°èª‰)", 
        intl: "çº¦ 28% (ç²¾è‹±åŒ–ç¨‹åº¦é«˜ï¼Œä¼ ç»Ÿè‹±å¼æ•™è‚²ä½“éªŒ)" 
    },
    { 
        name: "è¯ºä¸æ±‰å¤§å­¦ (Nottingham)", 
        city: "è¯ºä¸æ±‰", 
        coords: [52.9377, -1.1927], 
        qsRank: 97, 
        group: "ç½—ç´ é›†å›¢", 
        strength: "è¯å­¦ (å…¨è‹±å‰åˆ—)ã€å†œä¸šä¸æ—ä¸šã€èƒ½æºå·¥ç¨‹", 
        economy: "ä¼ ç»Ÿåˆ¶é€ ä¸šè½¬å‹åŸºåœ°ï¼Œç°ä»£åˆ¶è¯ (Boots æ€»éƒ¨) æ‰€åœ¨åœ°", 
        env: "å…¬è®¤çš„å…¨è‹±æœ€ç¾æ ¡å›­ä¹‹ä¸€ï¼Œåæ‹¥å·¨å¤§çš„æ¹–æ³Šä¸å…¬å›­ï¼Œæå…¶å®œå±…", 
        dist: "University Park (ä¸»æ ¡åŒº); Jubilee (åˆ›æ–°æ ¡åŒº); Sutton Bonington", 
        rent: "Â£150 - Â£250/å‘¨", 
        traffic: "æ ¡å†…ç›´é€šç”µè½¦ (Tram) ç›´è¾¾ç«è½¦ç«™ä¸å¸‚ä¸­å¿ƒ",
        employ: "80% (åœ¨ç”Ÿç‰©åˆ¶è¯ã€åˆ¶é€ å·¥ç¨‹é¢†åŸŸå…·æœ‰æ·±åšçš„è¡Œä¸šç§¯æ·€)", 
        intl: "çº¦ 31% (å›½é™…æ ¡å‹ç½‘ç»œæå…¶å¹¿æ³›)" 
    },
     { 
        name: "ä¼¦æ•¦ç›ä¸½å¥³ç‹å¤§å­¦ (QMUL)", 
        city: "ä¼¦æ•¦ (Mile End)", 
        coords: [51.5241, -0.0404], 
        qsRank: 120, 
        group: "ç½—ç´ å¤§å­¦é›†å›¢", 
        strength: "æ³•å­¦(çŸ¥è¯†äº§æƒæ³•å…¨è‹±é¢†å…ˆ)ã€åŒ»å­¦ã€æˆå‰§ã€ææ–™ç§‘å­¦", 
        economy: "ä½äºä¼¦æ•¦ä¸œåŒºï¼Œæ¯—é‚» Canary Wharf æ–°é‡‘èä¸­å¿ƒï¼Œåœ°ç†ä½ç½®æå…¶ä¾¿åˆ©é‡‘èå®ä¹ ", 
        env: "ä¼¦æ•¦ç½•è§çš„å•ä¸€ç»¼åˆæ€§å¤§å‹æ ¡å›­ï¼Œç‰©ä»·ç›¸å¯¹ä¼¦æ•¦ä¸­å¿ƒåŒºæ›´ä¸ºäº²æ°‘", 
        dist: "Mile End (ä¸»æ ¡åŒº); Whitechapel (åŒ»å­¦ä¸ç‰™åŒ»å­¦é™¢); Charterhouse Square (å¿ƒè„ç ”ç©¶æ‰€)", 
        rent: "Â£280 - Â£450/å‘¨", 
        traffic: "Mile End åœ°é“ç«™ (Central/District/H&C ä¸‰çº¿æ¢çº½ï¼Œäº¤é€šæå¿«)",
        employ: "80% (æ³•å­¦é™¢ä¸ä¼¦æ•¦å¾‹æ‰€è”ç³»æå…¶ç´§å¯†ï¼Œæ¯•ä¸šç”Ÿæˆä¸ºä¼¦æ•¦æ³•å¾‹ç•Œé‡è¦åŠ›é‡)", 
        intl: "çº¦ 50% (å…¨è‹±èƒŒæ™¯æœ€å¤šå…ƒåŒ–çš„å¤§å­¦ä¹‹ä¸€)" 
    }

];
    

    let selectedUnis = [];
    const map = L.map('map').setView([54.5, -2.5], 6);
    L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png').addTo(map);
    let markerLayer = L.markerClusterGroup().addTo(map);

    function getRentValue(rentStr) {
        const numbers = rentStr.match(/\d+/g);
        return numbers ? Math.max(...numbers.map(Number)) : 0;
    }

    function createPopupHtml(u) {
        return `
            <div class="u-popup">
                <div class="u-title">${u.name} <span class="tag-qs">QS #${u.qsRank}</span></div>
                <div class="u-row"><span class="label">ğŸ¢ æ ¡åŒºï¼š</span>${u.dist}</div>
                <div class="u-row"><span class="label">ğŸ¯ ä¼˜åŠ¿ï¼š</span>${u.strength}</div>
                <hr>
                <div class="u-row" style="color:#d35400;"><span class="label">ğŸ’° ç§Ÿé‡‘ï¼š</span>${u.rent}</div>
                <div class="u-row"><span class="label">ğŸŒ³ ç¯å¢ƒï¼š</span>${u.env}</div>
            </div>
        `;
    }

    function init() {
        const list = document.getElementById('university-list');
        universityData.sort((a,b) => a.qsRank - b.qsRank).forEach(u => {
            const div = document.createElement('div');
            div.className = 'uni-item';
            div.innerHTML = `<strong>#${u.qsRank}</strong> ${u.name}`;
            div.onclick = () => toggleUni(u, div);
            list.appendChild(div);
        });
        updateMap();
    }

    function toggleUni(u, el) {
        const idx = selectedUnis.indexOf(u.name);
        if(idx > -1) {
            selectedUnis.splice(idx, 1);
            el.classList.remove('selected');
        } else {
            if(selectedUnis.length >= 2) {
                alert("å¯¹æ¯”åŠŸèƒ½ä»…æ”¯æŒä¸¤æ‰€å­¦æ ¡ï¼Œè¯·å–æ¶ˆä¸€ä¸ªåå†é€‰æ‹©ã€‚");
                return;
            }
            selectedUnis.push(u.name);
            el.classList.add('selected');
        }
        updateMap();
        renderComparison();
    }

    function updateMap() {
        markerLayer.clearLayers();
        const displayData = selectedUnis.length > 0 
            ? universityData.filter(u => selectedUnis.includes(u.name))
            : universityData;

        displayData.forEach(u => {
            const m = L.circleMarker(u.coords, {
                radius: 8, fillColor: '#c8102e', color: '#fff', weight: 2, fillOpacity: 0.9
            });
            m.bindPopup(createPopupHtml(u));
            markerLayer.addLayer(m);
        });

        if(selectedUnis.length > 0) {
            const bounds = markerLayer.getBounds();
            if (bounds.isValid()) map.flyToBounds(bounds, {padding:[100,100], maxZoom: 10});
        } else {
            map.setView([54.5, -2.5], 6);
        }
    }

    function renderComparison() {
        const grid = document.getElementById('comp-grid');
        if (selectedUnis.length < 2) {
            grid.innerHTML = `<div class="placeholder">å·²å‹¾é€‰ ${selectedUnis.length} æ‰€ï¼Œè¿˜éœ€é€‰æ‹© ${2-selectedUnis.length} æ‰€å³å¯å¼€å¯å…­å¤§ç»´åº¦å¯¹æ¯”</div>`;
            return;
        }

        const a = universityData.find(u => u.name === selectedUnis[0]);
        const b = universityData.find(u => u.name === selectedUnis[1]);

        const valA = getRentValue(a.rent), valB = getRentValue(b.rent);
        const percentA = Math.min((valA / 600) * 100, 100);
        const percentB = Math.min((valB / 600) * 100, 100);

        let tableHtml = `
            <table class="comp-table">
                <tr><th class="dim-label">å¯¹æ¯”ç»´åº¦</th><th class="uni-name-header">${a.name}</th><th class="uni-name-header">${b.name}</th></tr>
                <tr><td class="dim-label">ğŸ“Š QS æ’å</td><td><span class="val-highlight">#${a.qsRank}</span></td><td><span class="val-highlight">#${b.qsRank}</span></td></tr>
                <tr><td class="dim-label">ğŸ“ åœ°ç†/äº¤é€š</td><td><b>${a.city}</b><br><small>${a.traffic}</small></td><td><b>${b.city}</b><br><small>${b.traffic}</small></td></tr>
                <tr><td class="dim-label">ğŸ¯ ä¼˜åŠ¿ä¸“ä¸š</td><td>${a.strength}</td><td>${b.strength}</td></tr>
                <tr><td class="dim-label">ğŸ“ å°±ä¸š/å›½é™…åŒ–</td><td>å°±ä¸šç‡ï¼š${a.employ}<br>å æ¯”ï¼š${a.intl}</td><td>å°±ä¸šç‡ï¼š${b.employ}<br>å æ¯”ï¼š${b.intl}</td></tr>
                <tr>
                    <td class="dim-label">ğŸ’° ç§Ÿé‡‘å‹åŠ›</td>
                    <td>
                        <b>${a.rent}</b>
                        <div class="rent-bar-container"><div class="rent-bar-fill" style="width:${percentA}%"></div></div>
                        <div class="rent-label"><span>ç»æµ</span><span>å‹åŠ›å¤§</span></div>
                    </td>
                    <td>
                        <b>${b.rent}</b>
                        <div class="rent-bar-container"><div class="rent-bar-fill" style="width:${percentB}%"></div></div>
                        <div class="rent-label"><span>ç»æµ</span><span>å‹åŠ›å¤§</span></div>
                    </td>
                </tr>
                <tr><td class="dim-label">ğŸŒ³ æ ¡å›­/ç»æµ</td><td><b>ç¯å¢ƒï¼š</b>${a.env}<br><b>ç‰¹è‰²ï¼š</b>${a.economy}</td><td><b>ç¯å¢ƒï¼š</b>${b.env}<br><b>ç‰¹è‰²ï¼š</b>${b.economy}</td></tr>
            </table>
            <div class="data-source">* æ•°æ®ç»Ÿè®¡æ¥æºäº 2026 å¹´ QS ä¸–ç•Œå¤§å­¦æ’ååŠå„æ ¡ 2025/26 æ‹›ç”Ÿç®€æŠ¥ã€‚ç§Ÿé‡‘å‹åŠ›ä»¥ Â£600/å‘¨ä¸ºä¸Šé™å‚ç…§ã€‚</div>
        `;
        grid.innerHTML = tableHtml;
    }

    function resetSelection() {
        selectedUnis = [];
        document.querySelectorAll('.uni-item').forEach(i => i.classList.remove('selected'));
        updateMap();
        renderComparison();
    }

    window.onload = init;
</script>
</body>
</html>